javascript:(function()%7B(function() %7B%0A    'use strict'%3B%0A%0A    %2F%2F Add styles%0A    const style %3D document.createElement('style')%3B%0Astyle.textContent %3D %60%0A        .help-icon %7B%0A            display%3A inline-block%3B%0A            width%3A 16px%3B%0A            height%3A 16px%3B%0A            background%3A %234285f4%3B%0A            color%3A white%3B%0A            border-radius%3A 50%25%3B%0A            text-align%3A center%3B%0A            line-height%3A 16px%3B%0A            font-size%3A 12px%3B%0A            margin-left%3A 8px%3B%0A            cursor%3A help%3B%0A        %7D%0A        %0A        .advanced-section %7B%0A            margin-top%3A 16px%3B%0A            border-top%3A 1px solid %23ddd%3B%0A            padding-top%3A 16px%3B%0A            display%3A none%3B%0A        %7D%0A        %0A        .parameter-row %7B%0A            display%3A flex%3B%0A            align-items%3A center%3B%0A            margin-bottom%3A 12px%3B%0A        %7D%0A        %0A        .parameter-input %7B%0A            width%3A 80px%3B%0A            margin-left%3A 8px%3B%0A            padding%3A 4px%3B%0A            border%3A 1px solid %23ddd%3B%0A            border-radius%3A 4px%3B%0A        %7D%0A        %0A        .advanced-section.visible %7B%0A            display%3A block%3B%0A        %7D%0A        %0A        .basic-section.hidden %7B%0A            display%3A none%3B%0A        %7D%0A        %23typing-blocker %7B%0A            position%3A absolute%3B%0A            background%3A transparent%3B%0A            z-index%3A 9999%3B%0A            display%3A none%3B%0A            cursor%3A not-allowed%3B%0A            pointer-events%3A none%3B%0A        %7D%0A        .typing-blocker-active %7B%0A            pointer-events%3A auto !important%3B%0A            background%3A rgba(255%2C 255%2C 255%2C 0.1) !important%3B%0A        %7D%0A%0A%0A        .typing-simulator-button-active %7B%0A            background%3A %23ff4444 !important%3B%0A            color%3A white !important%3B%0A            opacity%3A 1 !important%3B%0A        %7D%0A        %23typing-simulator-panel %7B%0A            position%3A fixed%3B%0A            top%3A 50%25%3B%0A            left%3A 50%25%3B%0A            transform%3A translate(-50%25%2C -50%25)%3B%0A            background%3A white%3B%0A            padding%3A 20px%3B%0A            border-radius%3A 8px%3B%0A            box-shadow%3A 0 2px 10px rgba(0%2C0%2C0%2C0.1)%3B%0A            z-index%3A 10000%3B%0A            width%3A 400px%3B%0A            font-family%3A Arial%2C sans-serif%3B%0A            display%3A none%3B%0A        %7D%0A        .typing-simulator-input %7B%0A            width%3A 100%25%3B%0A            margin%3A 8px 0%3B%0A            padding%3A 8px%3B%0A            box-sizing%3A border-box%3B%0A        %7D%0A        .typing-simulator-label %7B%0A            display%3A block%3B%0A            margin-top%3A 12px%3B%0A        %7D%0A        .typing-simulator-button %7B%0A            background%3A %234285f4%3B%0A            color%3A white%3B%0A            border%3A none%3B%0A            padding%3A 8px 16px%3B%0A            border-radius%3A 4px%3B%0A            cursor%3A pointer%3B%0A            margin-top%3A 12px%3B%0A        %7D%0A        .typing-simulator-close %7B%0A            position%3A absolute%3B%0A            right%3A 10px%3B%0A            top%3A 10px%3B%0A            cursor%3A pointer%3B%0A            font-size%3A 20px%3B%0A        %7D%0A    %60%3B%0Adocument.head.appendChild(style)%3B%0A%0A%0A    const typingProfiles %3D %7B%0A        average%3A %7B%0A            baseIKI%3A 238.66%2C%0A            ikiSD%3A 111.60%2C%0A            rolloverRatio%3A 0.25%2C%0A            errorRate%3A 0.0117%2C%0A            errorCorrectionRange%3A 3%2C  %2F%2F Max chars to go back%0A            errorCorrectionChance%3A 0.8 %2F%2F Chance that we'll correct an error%0A        %7D%2C%0A        slower%3A %7B%0A            baseIKI%3A 1200%2C%0A            ikiSD%3A 111.60%2C%0A            rolloverRatio%3A 0.25%2C%0A            errorRate%3A 0.0117%2C%0A            errorCorrectionRange%3A 3%2C  %2F%2F Max chars to go back%0A            errorCorrectionChance%3A 0.8 %2F%2F Chance that we'll correct an error%0A        %7D%2C%0A         Extremelyslow%3A %7B%0A            baseIKI%3A 5000%2C%0A            ikiSD%3A 111.60%2C%0A            rolloverRatio%3A 0.25%2C%0A            errorRate%3A 0.0117%2C%0A            errorCorrectionRange%3A 3%2C  %2F%2F Max chars to go back%0A            errorCorrectionChance%3A 0.8 %2F%2F Chance that we'll correct an error%0A        %7D%2C%0A        fast%3A %7B%0A            baseIKI%3A 180%2C%0A            ikiSD%3A 90%2C%0A            rolloverRatio%3A 0.3%2C%0A            errorRate%3A 0.02%2C%0A            errorCorrectionRange%3A 12%2C%0A            errorCorrectionChance%3A 0.55%0A        %7D%2C%0A        slow%3A %7B%0A            baseIKI%3A 400%2C%0A            ikiSD%3A 150%2C%0A            rolloverRatio%3A 0.2%2C%0A            errorRate%3A 0.015%2C%0A            errorCorrectionRange%3A 20%2C%0A            errorCorrectionChance%3A 0.7%0A        %7D%0A    %7D%3B%0A%0A    %2F%2F Debug function%0A    function debug(msg) %7B%0A        console.log('%5BType Simulator Debug%5D%3A'%2C msg)%3B%0A    %7D%0A%0A    %2F%2F Create blocker overlay%0A    function createBlocker() %7B%0A        const blocker %3D document.createElement('div')%3B%0A        blocker.id %3D 'typing-blocker'%3B%0A%0A        function positionBlocker() %7B%0A            const editor %3D document.querySelector('.kix-appview-editor')%3B%0A            if (editor) %7B%0A                const rect %3D editor.getBoundingClientRect()%3B%0A                blocker.style.top %3D %60%24%7Brect.top%7Dpx%60%3B%0A                blocker.style.left %3D %60%24%7Brect.left%7Dpx%60%3B%0A                blocker.style.width %3D %60%24%7Brect.width%7Dpx%60%3B%0A                blocker.style.height %3D %60%24%7Brect.height%7Dpx%60%3B%0A            %7D%0A        %7D%0A%0A        %2F%2F Initial positioning%0A        positionBlocker()%3B%0A%0A        %2F%2F Update position when window is resized or scrolled%0A        window.addEventListener('resize'%2C positionBlocker)%3B%0A        document.addEventListener('scroll'%2C positionBlocker)%3B%0A%0A        %2F%2F Prevent default on all mouse and keyboard events%0A        blocker.addEventListener('mousedown'%2C e %3D> e.preventDefault()%2C true)%3B%0A        blocker.addEventListener('keydown'%2C e %3D> e.preventDefault()%2C true)%3B%0A        blocker.addEventListener('click'%2C e %3D> e.preventDefault()%2C true)%3B%0A%0A        document.body.appendChild(blocker)%3B%0A    %7D%0A%0A    %2F%2F Update time estimate%0A    function updateTimeEstimate() %7B%0A        debug('Updating time estimate')%3B%0A        const text %3D document.querySelector('%23text-input').value%3B%0A        let baseIKI%3B%0A        %0A        const isAdvanced %3D document.querySelector('%23advanced-mode').checked%3B%0A        if (isAdvanced) %7B%0A            baseIKI %3D parseFloat(document.querySelector('%23baseIKI').value)%3B%0A        %7D else %7B%0A            const profile %3D document.querySelector('%23profile-select').value%3B%0A            baseIKI %3D typingProfiles%5Bprofile%5D.baseIKI%3B%0A        %7D%0A%0A        const estimatedTimeMs %3D text.length * baseIKI%3B%0A        const estimatedTimeSec %3D Math.round(estimatedTimeMs %2F 1000)%3B%0A        const minutes %3D Math.floor(estimatedTimeSec %2F 60)%3B%0A        const seconds %3D estimatedTimeSec %25 60%3B%0A%0A        document.querySelector('%23time-estimate').textContent %3D%0A            %60Estimated time%3A %24%7Bminutes%7Dm %24%7Bseconds%7Ds%60%3B%0A    %7D%0A%0A    class TypeSimulator %7B%0A        constructor(config %3D %7B%7D) %7B%0A            this.baseIKI %3D config.baseIKI %7C%7C 238.66%3B%0A            this.ikiSD %3D config.ikiSD %7C%7C 111.60%3B%0A            this.keypressDuration %3D config.keypressDuration %7C%7C 116.25%3B%0A            this.keypressDurationSD %3D config.keypressDurationSD %7C%7C 23.88%3B%0A            this.rolloverRatio %3D config.rolloverRatio %7C%7C 0.25%3B%0A            this.errorRate %3D config.errorRate %7C%7C 0.0117%3B%0A            this.errorCorrectionChance %3D config.errorCorrectionChance %7C%7C 0.8%3B%0A            this.errorCorrectionRange %3D config.errorCorrectionRange %7C%7C 3%3B%0A%0A            this.leftHandKeys %3D new Set('qwertasdfgzxcvb'.split(''))%3B%0A            this.rightHandKeys %3D new Set('yuiophjklnm'.split(''))%3B%0A%0A            this.lastKeyTime %3D 0%3B%0A            this.lastKey %3D null%3B%0A            this.timings %3D %5B%5D%3B%0A            this.errorStats %3D %7B%0A                totalErrors%3A 0%0A            %7D%3B%0A        %7D%0A%0A        gaussianRandom(mean%2C standardDeviation) %7B%0A            let u %3D 0%2C v %3D 0%3B%0A            while(u %3D%3D%3D 0) u %3D Math.random()%3B%0A            while(v %3D%3D%3D 0) v %3D Math.random()%3B%0A            const normal %3D Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v)%3B%0A            return mean %2B standardDeviation * normal%3B%0A        %7D%0A%0A        getTypingHand(key) %7B%0A            if (this.leftHandKeys.has(key.toLowerCase())) return 'left'%3B%0A            if (this.rightHandKeys.has(key.toLowerCase())) return 'right'%3B%0A            return 'either'%3B%0A        %7D%0A%0A        calculateIKIAdjustment(currentKey) %7B%0A            if (!this.lastKey) return 0%3B%0A%0A            if (currentKey.toLowerCase() %3D%3D%3D this.lastKey.toLowerCase()) %7B%0A                return this.baseIKI < 200 %3F 30 %3A -150%3B%0A            %7D%0A%0A            const lastHand %3D this.getTypingHand(this.lastKey)%3B%0A            const currentHand %3D this.getTypingHand(currentKey)%3B%0A%0A            if (lastHand !%3D%3D currentHand %26%26 lastHand !%3D%3D 'either' %26%26 currentHand !%3D%3D 'either') %7B%0A                return -15%3B%0A            %7D%0A%0A            if (currentHand %3D%3D%3D 'left') %7B%0A                return 10%3B%0A            %7D%0A%0A            return 0%3B%0A        %7D%0A%0A        typeChar(char%2C isCorrection %3D false) %7B%0A            const now %3D this.lastKeyTime %3F this.lastKeyTime %3A Date.now()%3B%0A            let iki %3D this.gaussianRandom(this.baseIKI%2C this.ikiSD)%3B%0A            iki %2B%3D this.calculateIKIAdjustment(char)%3B%0A            iki %3D Math.max(60%2C iki)%3B%0A%0A            const duration %3D this.gaussianRandom(this.keypressDuration%2C this.keypressDurationSD)%3B%0A            const useRollover %3D Math.random() < this.rolloverRatio%3B%0A%0A            let timing %3D %7B%0A                key%3A char%2C%0A                keydownTime%3A useRollover %26%26 this.lastKeyTime %3F this.lastKeyTime - 30 %3A now %2B iki%2C%0A                keyupTime%3A null%2C%0A                isTypo%3A false%2C%0A                isCorrection%3A isCorrection%0A            %7D%3B%0A%0A            %2F%2F Only check for typos if this isn't already a correction%0A            if (!isCorrection %26%26 Math.random() < this.errorRate) %7B%0A                const adjacentKeys %3D this.getAdjacentKeys(char)%3B%0A                if (adjacentKeys.length > 0) %7B%0A                    timing.key %3D adjacentKeys%5BMath.floor(Math.random() * adjacentKeys.length)%5D%3B%0A                    timing.isTypo %3D true%3B%0A                    timing.intendedKey %3D char%3B %2F%2F Store the intended key%0A                    this.errorStats.totalErrors%2B%2B%3B%0A                %7D%0A            %7D%0A%0A            timing.keyupTime %3D timing.keydownTime %2B duration%3B%0A            this.lastKeyTime %3D timing.keydownTime%3B%0A            this.lastKey %3D char%3B%0A%0A            return timing%3B%0A        %7D%0A%0A        getAdjacentKeys(key) %7B%0A            const keyboard %3D %7B%0A                'q'%3A %5B'w'%2C'a'%5D%2C%0A                'w'%3A %5B'q'%2C'e'%2C's'%5D%2C%0A                'e'%3A %5B'w'%2C'r'%2C'd'%5D%2C%0A                'r'%3A %5B'e'%2C't'%2C'f'%5D%2C%0A                't'%3A %5B'r'%2C'y'%2C'g'%5D%2C%0A                'y'%3A %5B't'%2C'u'%2C'h'%5D%2C%0A                'u'%3A %5B'y'%2C'i'%2C'j'%5D%2C%0A                'i'%3A %5B'u'%2C'o'%2C'k'%5D%2C%0A                'o'%3A %5B'i'%2C'p'%2C'l'%5D%2C%0A                'p'%3A %5B'o'%2C'%5B'%5D%2C%0A                'a'%3A %5B'q'%2C's'%2C'z'%5D%2C%0A                's'%3A %5B'w'%2C'a'%2C'd'%2C'x'%5D%2C%0A                'd'%3A %5B'e'%2C's'%2C'f'%2C'c'%5D%2C%0A                'f'%3A %5B'r'%2C'd'%2C'g'%2C'v'%5D%2C%0A                'g'%3A %5B't'%2C'f'%2C'h'%2C'b'%5D%2C%0A                'h'%3A %5B'y'%2C'g'%2C'j'%2C'n'%5D%2C%0A                'j'%3A %5B'u'%2C'h'%2C'k'%2C'm'%5D%2C%0A                'k'%3A %5B'i'%2C'j'%2C'l'%5D%2C%0A                'l'%3A %5B'o'%2C'k'%2C'%3B'%5D%2C%0A                'z'%3A %5B'a'%2C'x'%5D%2C%0A                'x'%3A %5B's'%2C'z'%2C'c'%5D%2C%0A                'c'%3A %5B'd'%2C'x'%2C'v'%5D%2C%0A                'v'%3A %5B'f'%2C'c'%2C'b'%5D%2C%0A                'b'%3A %5B'g'%2C'v'%2C'n'%5D%2C%0A                'n'%3A %5B'h'%2C'b'%2C'm'%5D%2C%0A                'm'%3A %5B'j'%2C'n'%2C'%2C'%5D%0A            %7D%3B%0A            return keyboard%5Bkey.toLowerCase()%5D %7C%7C %5B%5D%3B%0A        %7D%0A%0A        typeText(text) %7B%0A            %2F%2F Remove the pre-computation of typos - we'll handle them in real-time%0A            this.lastKeyTime %3D Date.now()%3B%0A            this.timings %3D %5B%5D%3B%0A            this.errorStats.totalErrors %3D 0%3B%0A%0A            for (let i %3D 0%3B i < text.length%3B i%2B%2B) %7B%0A                const timing %3D this.typeChar(text%5Bi%5D)%3B%0A                this.timings.push(timing)%3B%0A            %7D%0A%0A            return this.timings%3B%0A        %7D%0A    %7D%0A%0A%0A    class EnhancedTypingSimulator %7B%0A    constructor(targetFrame%2C options %3D %7B%7D) %7B%0A        this.targetFrame %3D targetFrame%3B%0A        this.isTyping %3D false%3B%0A        this.isPaused %3D false%3B   %2F%2F add this%0A%0A        this.typeSimulator %3D new TypeSimulator(%7B%0A            baseIKI%3A options.baseIKI %7C%7C 120%2C%0A            ikiSD%3A options.ikiSD %7C%7C 11%2C%0A            keypressDuration%3A 116.25%2C%0A            keypressDurationSD%3A 23.88%2C%0A            rolloverRatio%3A options.rolloverRatio %7C%7C 0.50%2C%0A            errorRate%3A options.errorRate %7C%7C 0.008%2C%0A            errorCorrectionRange%3A options.errorCorrectionRange %7C%7C 15%2C%0A            errorCorrectionChance%3A options.errorCorrectionChance %7C%7C 0.8%0A        %7D)%3B%0A%0A        this.startTime %3D null%3B%0A        this.errorStats %3D %7B%0A            totalErrors%3A 0%0A        %7D%3B%0A%0A        %2F%2F Add state tracking for error correction%0A        this.currentText %3D ''%3B%0A        this.isInErrorCorrection %3D false%3B%0A        this.lastTypoPosition %3D -1%3B%0A%0A    %7D%0A%0A%0A        stopTyping() %7B%0A    this.isTyping %3D false%3B%0A    this.isPaused %3D false%3B%0A%7D%0A%0Apause() %7B%0A    this.isPaused %3D true%3B%0A%7D%0A%0Aresume() %7B%0A    this.isPaused %3D false%3B%0A%7D%0A%0A%0A        async simulateBackspace(frameWindow%2C frameDoc) %7B%0A            const backspaceEvent %3D %7B%0A                key%3A 'Backspace'%2C%0A                code%3A 'Backspace'%2C%0A                keyCode%3A 8%2C%0A                which%3A 8%2C%0A                location%3A 0%2C%0A                timeStamp%3A Date.now()%2C%0A            %7D%3B%0A%0A            await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keydown'%2C backspaceEvent)%3B%0A            await this.delay(30)%3B%0A            await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keyup'%2C backspaceEvent)%3B%0A            await this.delay(this.typeSimulator.gaussianRandom(this.typeSimulator.baseIKI%2C this.typeSimulator.ikiSD))%3B%0A        %7D%0A%0A        async simulateKeySequence(frameWindow%2C frameDoc%2C timing) %7B%0A            const char %3D timing.key%3B%0A            %0A            %2F%2F Special handling for newline%0A            if (char %3D%3D%3D '%5Cn') %7B%0A                const enterEvent %3D %7B%0A                    bubbles%3A true%2C%0A                    cancelable%3A true%2C%0A                    view%3A frameWindow%2C%0A                    key%3A 'Enter'%2C%0A                    code%3A 'Enter'%2C%0A                    keyCode%3A 13%2C%0A                    which%3A 13%2C%0A                    location%3A 0%2C%0A                    timeStamp%3A Date.now()%2C%0A                %7D%3B%0A        %0A                await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keydown'%2C enterEvent)%3B%0A                await this.delay(Math.min(30%2C timing.keyupTime - timing.keydownTime))%3B%0A                await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keypress'%2C enterEvent)%3B%0A                await this.delay(Math.max(0%2C timing.keyupTime - timing.keydownTime - 30))%3B%0A                await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keyup'%2C enterEvent)%3B%0A                return%3B%0A            %7D%0A            %0A            const isUpperCase %3D char !%3D%3D char.toLowerCase()%3B%0A            const keyCode %3D char.charCodeAt(0)%3B%0A            const code %3D %60Key%24%7Bchar.toUpperCase()%7D%60%3B%0A        %0A            const baseEvent %3D %7B%0A                bubbles%3A true%2C%0A                cancelable%3A true%2C%0A                view%3A frameWindow%2C%0A                key%3A char%2C%0A                code%3A code%2C%0A                keyCode%3A keyCode%2C%0A                which%3A keyCode%2C%0A                location%3A 0%2C%0A                timeStamp%3A Date.now()%2C%0A                shiftKey%3A isUpperCase%0A            %7D%3B%0A        %0A            if (isUpperCase) %7B%0A                await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keydown'%2C %7B%0A                    ...baseEvent%2C%0A                    key%3A 'Shift'%2C%0A                    code%3A 'ShiftLeft'%2C%0A                    keyCode%3A 16%2C%0A                    which%3A 16%0A                %7D)%3B%0A            %7D%0A        %0A            await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keydown'%2C baseEvent)%3B%0A            await this.delay(Math.min(30%2C timing.keyupTime - timing.keydownTime))%3B%0A            await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keypress'%2C baseEvent)%3B%0A            await this.delay(Math.max(0%2C timing.keyupTime - timing.keydownTime - 30))%3B%0A            await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keyup'%2C baseEvent)%3B%0A        %0A            if (isUpperCase) %7B%0A                await this.dispatchKeyEvent(frameWindow%2C frameDoc%2C 'keyup'%2C %7B%0A                    ...baseEvent%2C%0A                    key%3A 'Shift'%2C%0A                    code%3A 'ShiftLeft'%2C%0A                    keyCode%3A 16%2C%0A                    which%3A 16%0A                %7D)%3B%0A            %7D%0A        %7D%0A%0A        async dispatchKeyEvent(frameWindow%2C frameDoc%2C eventType%2C eventInit) %7B%0A            try %7B%0A                const event %3D new frameWindow.KeyboardEvent(eventType%2C %7B%0A                    ...eventInit%2C%0A                    bubbles%3A true%2C%0A                    cancelable%3A true%2C%0A                    composed%3A true%0A                %7D)%3B%0A%0A                Object.defineProperties(event%2C %7B%0A                    keyCode%3A %7B value%3A eventInit.keyCode %7D%2C%0A                    which%3A %7B value%3A eventInit.which %7D%2C%0A                    key%3A %7B value%3A eventInit.key %7D%2C%0A                    code%3A %7B value%3A eventInit.code %7D%0A                %7D)%3B%0A%0A                const dispatched %3D frameDoc.dispatchEvent(event)%3B%0A                if (!dispatched) %7B%0A                    %2F%2Fconsole.warn(%60Event %24%7BeventType%7D was cancelled%60)%3B%0A                %7D%0A            %7D catch (error) %7B%0A                console.error(%60Error dispatching %24%7BeventType%7D%3A%60%2C error)%3B%0A            %7D%0A        %7D%0A%0A        delay(ms) %7B%0A            return new Promise(resolve %3D> setTimeout(resolve%2C ms))%3B%0A        %7D%0A%0A        async typeText(text) %7B%0A            if (!this.targetFrame) %7B%0A                throw new Error('Target frame not found')%3B%0A            %7D%0A%0A            const frameWindow %3D this.targetFrame.contentWindow%3B%0A            const frameDoc %3D frameWindow.document%3B%0A            this.startTime %3D Date.now()%3B%0A            this.isTyping %3D true%3B%0A%0A                for (let i %3D 0%3B i < text.length%3B i%2B%2B) %7B%0A                if (!this.isTyping) break%3B%0A%0A                    %2F%2F ✅ Pause loop%0A                 while (this.isPaused) %7B%0A                await this.delay(100)%3B%0A                %7D%0A%0A%0A                const timing %3D this.typeSimulator.typeChar(text%5Bi%5D%2C false)%3B%0A                const currentTime %3D Date.now()%3B%0A                const targetTime %3D this.startTime %2B (timing.keydownTime - this.typeSimulator.lastKeyTime)%3B%0A%0A                const waitTime %3D Math.max(0%2C targetTime - currentTime)%3B%0A                if (waitTime > 0) %7B%0A                    await this.delay(waitTime)%3B%0A                %7D%0A%0A                %2F%2F Handle typo and potential correction%0A                if (timing.isTypo) %7B%0A                    this.currentText %2B%3D timing.key%3B %2F%2F Add the typo%0A                    this.lastTypoPosition %3D this.currentText.length - 1%3B%0A%0A                    %2F%2F Simulate typing the typo%0A                    await this.simulateKeySequence(frameWindow%2C frameDoc%2C timing)%3B%0A%0A                    %2F%2F Check if we should enter error correction mode%0A                    if (Math.random() < this.typeSimulator.errorCorrectionChance) %7B%0A                        %2F%2F Determine how many characters to delete%0A                        const charsToDelete %3D Math.floor(Math.random() * this.typeSimulator.errorCorrectionRange) %2B 1%3B%0A                        const actualCharsToDelete %3D Math.min(charsToDelete%2C this.currentText.length)%3B%0A%0A                        %2F%2F Delete characters%0A                        for (let j %3D 0%3B j < actualCharsToDelete%3B j%2B%2B) %7B%0A                            this.currentText %3D this.currentText.slice(0%2C -1)%3B%0A                            await this.simulateBackspace(frameWindow%2C frameDoc)%3B%0A                        %7D%0A%0A                        %2F%2F Retype the correct sequence%0A                        const startPos %3D i - actualCharsToDelete %2B 1%3B%0A                        for (let j %3D startPos%3B j <%3D i%3B j%2B%2B) %7B%0A                            const correctionTiming %3D this.typeSimulator.typeChar(text%5Bj%5D%2C true)%3B%0A                            this.currentText %2B%3D text%5Bj%5D%3B%0A                            await this.simulateKeySequence(frameWindow%2C frameDoc%2C correctionTiming)%3B%0A                        %7D%0A                    %7D%0A                %7D else %7B%0A                    this.currentText %2B%3D timing.key%3B%0A                    await this.simulateKeySequence(frameWindow%2C frameDoc%2C timing)%3B%0A                %7D%0A            %7D%0A%0A            this.isTyping %3D false%3B%0A        %7D%0A    %7D%0A%0A    let currentSimulator %3D null%3B%0A%0A%0A    async function simulateTyping(text%2C options %3D %7B%7D) %7B%0A        const textFrame %3D document.querySelector('.docs-texteventtarget-iframe')%3B%0A        if (!textFrame) %7B%0A            throw new Error('Text frame not found')%3B%0A        %7D%0A%0A        %2F%2F Process text to handle special characters and line breaks%0A        const processedText %3D text%0A            .replace(%2F%5C%5Cn%2Fg%2C '%5Cn')  %2F%2F Convert %5Cn to actual line breaks%0A            .replace(%2F%5C%5Ct%2Fg%2C '%5Ct')  %2F%2F Convert %5Ct to actual tabs%0A            .replace(%2F%5C%5Cr%2Fg%2C '%5Cr')%3B %2F%2F Convert %5Cr to carriage returns%0A%0A        const simulator %3D new EnhancedTypingSimulator(textFrame%2C %7B%0A            baseIKI%3A options.baseIKI %7C%7C 120%2C%0A            ikiSD%3A options.ikiSD %7C%7C 11%2C%0A            rolloverRatio%3A options.rolloverRatio %7C%7C 0.25%2C%0A            errorRate%3A options.errorRate %7C%7C 0.0117%2C%0A            errorCorrectionRange%3A options.errorCorrectionRange %7C%7C 15%2C%0A            errorCorrectionChance%3A options.errorCorrectionChance %7C%7C 0.8%0A        %7D)%3B%0A%0A        currentSimulator %3D simulator%3B%0A%0A        try %7B%0A            await simulator.typeText(processedText)%3B%0A            console.log('Typing complete')%3B%0A            return simulator%3B%0A        %7D catch (error) %7B%0A            console.error('Typing failed%3A'%2C error)%3B%0A            throw error%3B%0A        %7D%0A    %7D%0A%0A%0A%0A    async function startTyping() %7B%0A        debug('Starting typing simulation')%3B%0A        const text %3D document.querySelector('%23text-input').value%3B%0A        if (!text) %7B%0A            alert('Please enter some text to type')%3B%0A            return%3B%0A        %7D%0A    %0A        document.querySelector('%23typing-simulator-panel').style.display %3D 'none'%3B%0A    %0A        const blocker %3D document.querySelector('%23typing-blocker')%3B%0A        const button %3D document.querySelector('%23type-simulator-button')%3B%0A    %0A        const editor %3D document.querySelector('.docs-editor-container')%3B%0A        if (editor) %7B%0A            const rect %3D editor.getBoundingClientRect()%3B%0A            blocker.style.top %3D %60%24%7Brect.top%7Dpx%60%3B%0A            blocker.style.left %3D %60%24%7Brect.left%7Dpx%60%3B%0A            blocker.style.width %3D %60%24%7Brect.width%7Dpx%60%3B%0A            blocker.style.height %3D %60%24%7Brect.height%7Dpx%60%3B%0A        %7D%0A    %0A        blocker.style.display %3D 'block'%3B%0A        blocker.classList.add('typing-blocker-active')%3B%0A        button.classList.add('typing-simulator-button-active')%3B%0A        button.textContent %3D 'Stop Typing'%3B%0A        document.querySelector('%23pause-simulator-button').style.display %3D 'inline-block'%3B%0A%0A    %0A        %2F%2F Replace these two lines%3A%0A        %2F%2F const profile %3D document.querySelector('%23profile-select').value%3B%0A        %2F%2F const options %3D typingProfiles%5Bprofile%5D%3B%0A        %0A        %2F%2F With this new code%3A%0A        const isAdvanced %3D document.querySelector('%23advanced-mode').checked%3B%0A        let options%3B%0A        %0A        if (isAdvanced) %7B%0A            options %3D %7B%0A                baseIKI%3A parseFloat(document.querySelector('%23baseIKI').value)%2C%0A                ikiSD%3A parseFloat(document.querySelector('%23ikiSD').value)%2C%0A                rolloverRatio%3A parseFloat(document.querySelector('%23rolloverRatio').value)%2C%0A                errorRate%3A parseFloat(document.querySelector('%23errorRate').value)%2C%0A                errorCorrectionRange%3A parseInt(document.querySelector('%23errorCorrectionRange').value)%2C%0A                errorCorrectionChance%3A parseFloat(document.querySelector('%23errorCorrectionChance').value)%0A            %7D%3B%0A        %7D else %7B%0A            const profile %3D document.querySelector('%23profile-select').value%3B%0A            options %3D typingProfiles%5Bprofile%5D%3B%0A        %7D%0A    %0A        try %7B%0A            await simulateTyping(text%2C options)%3B%0A        %7D catch (error) %7B%0A            console.error('Typing failed%3A'%2C error)%3B%0A            alert('An error occurred while typing. Check the console for details.')%3B%0A        %7D finally %7B%0A            blocker.style.display %3D 'none'%3B%0A            blocker.classList.remove('typing-blocker-active')%3B%0A            button.classList.remove('typing-simulator-button-active')%3B%0A            button.textContent %3D 'Type Simulator'%3B%0A            document.querySelector('%23pause-simulator-button').style.display %3D 'none'%3B%0A            document.querySelector('%23pause-simulator-button').textContent %3D 'Pause'%3B%0A            currentSimulator %3D null%3B%0A%0A        %7D%0A    %7D%0A%0A    function createUI() %7B%0A        debug('Creating UI elements')%3B%0A    %0A        %2F%2F Create blocker first%0A        createBlocker()%3B%0A    %0A        %2F%2F Create button%0A        const button %3D document.createElement('div')%3B%0A        button.setAttribute('role'%2C 'button')%3B%0A        button.className %3D 'goog-inline-block jfk-button jfk-button-standard docs-titlebar-button type-simulator-main-button'%3B%0A        button.id %3D 'type-simulator-button'%3B%0A        button.textContent %3D 'Type Simulator'%3B%0A%0A        %2F%2F ✅ Pause button%0A        const pauseButton %3D document.createElement('div')%3B%0A        pauseButton.setAttribute('role'%2C 'button')%3B%0A        pauseButton.className %3D 'goog-inline-block jfk-button jfk-button-standard docs-titlebar-button'%3B%0A        pauseButton.id %3D 'pause-simulator-button'%3B%0A        pauseButton.textContent %3D 'Pause'%3B%0A        pauseButton.style.marginLeft %3D '6px'%3B%0A        pauseButton.style.display %3D 'none'%3B%0A%0A    %0A        %2F%2F Create panel%0A        const panel %3D document.createElement('div')%3B%0A        panel.id %3D 'typing-simulator-panel'%3B%0A        panel.style.display %3D 'none'%3B%0A    %0A        %2F%2F Close button%0A        const closeBtn %3D document.createElement('span')%3B%0A        closeBtn.className %3D 'typing-simulator-close'%3B%0A        closeBtn.textContent %3D '×'%3B%0A        panel.appendChild(closeBtn)%3B%0A    %0A        %2F%2F Title%0A        const title %3D document.createElement('h3')%3B%0A        title.textContent %3D 'Typing Simulator'%3B%0A        panel.appendChild(title)%3B%0A    %0A        %2F%2F Advanced mode checkbox%0A        const advancedRow %3D document.createElement('div')%3B%0A        advancedRow.className %3D 'parameter-row'%3B%0A        const advancedCheck %3D document.createElement('input')%3B%0A        advancedCheck.type %3D 'checkbox'%3B%0A        advancedCheck.id %3D 'advanced-mode'%3B%0A        const advancedLabel %3D document.createElement('label')%3B%0A        advancedLabel.htmlFor %3D 'advanced-mode'%3B%0A        advancedLabel.textContent %3D 'Advanced Mode'%3B%0A        advancedRow.appendChild(advancedCheck)%3B%0A        advancedRow.appendChild(advancedLabel)%3B%0A        panel.appendChild(advancedRow)%3B%0A    %0A        %2F%2F Create basic section%0A        const basicSection %3D document.createElement('div')%3B%0A        basicSection.className %3D 'basic-section'%3B%0A    %0A        %2F%2F Create profile selector%0A        const profileLabel %3D document.createElement('label')%3B%0A        profileLabel.className %3D 'typing-simulator-label'%3B%0A        profileLabel.textContent %3D 'Profile%3A'%3B%0A    %0A        const profileSelect %3D document.createElement('select')%3B%0A        profileSelect.id %3D 'profile-select'%3B%0A        profileSelect.className %3D 'typing-simulator-input'%3B%0A    %0A        const profiles %3D %5B%0A            %7B value%3A 'average'%2C text%3A 'Average (~52 WPM)' %7D%2C%0A            %7B value%3A 'slower'%2C text%3A 'slower (~12.5 WPM)' %7D%2C%0A            %7B value%3A 'Extremely slow'%2C text%3A 'Extremely slow (~3 WPM)' %7D%2C%0A            %7B value%3A 'fast'%2C text%3A 'Fast (~75 WPM)' %7D%2C%0A            %7B value%3A 'slow'%2C text%3A 'Slow (~25 WPM)' %7D%0A        %5D%3B%0A    %0A        profiles.forEach(profile %3D> %7B%0A            const option %3D document.createElement('option')%3B%0A            option.value %3D profile.value%3B%0A            option.textContent %3D profile.text%3B%0A            profileSelect.appendChild(option)%3B%0A        %7D)%3B%0A    %0A        %2F%2F Add profile selector to basic section%0A        basicSection.appendChild(profileLabel)%3B%0A        basicSection.appendChild(profileSelect)%3B%0A        panel.appendChild(basicSection)%3B%0A    %0A        %2F%2F Create advanced section%0A        const advancedSection %3D document.createElement('div')%3B%0A        advancedSection.className %3D 'advanced-section'%3B%0A    %0A        %2F%2F Add parameter inputs%0A        const parameters %3D %5B%0A            %7B id%3A 'baseIKI'%2C label%3A 'Base Inter-key Interval (ms)'%2C value%3A 238.66%2C help%3A 'Average time between keystrokes in milliseconds' %7D%2C%0A            %7B id%3A 'ikiSD'%2C label%3A 'Timing Variation'%2C value%3A 111.60%2C help%3A 'Standard deviation in typing speed' %7D%2C%0A            %7B id%3A 'rolloverRatio'%2C label%3A 'Key Overlap Chance'%2C value%3A 0.25%2C help%3A 'Probability of overlapping keystrokes (0-1)' %7D%2C%0A            %7B id%3A 'errorRate'%2C label%3A 'Error Rate'%2C value%3A 0.0117%2C help%3A 'Probability of making a typo (0-1)' %7D%2C%0A            %7B id%3A 'errorCorrectionRange'%2C label%3A 'Max Correction Distance'%2C value%3A 3%2C help%3A 'Maximum characters to backspace when fixing a typo' %7D%2C%0A            %7B id%3A 'errorCorrectionChance'%2C label%3A 'Correction Chance'%2C value%3A 0.8%2C help%3A 'Probability of correcting a typo (0-1)' %7D%0A        %5D%3B%0A    %0A        parameters.forEach(param %3D> %7B%0A            const row %3D document.createElement('div')%3B%0A            row.className %3D 'parameter-row'%3B%0A    %0A            const label %3D document.createElement('label')%3B%0A            label.textContent %3D param.label%3B%0A            label.htmlFor %3D param.id%3B%0A    %0A            const input %3D document.createElement('input')%3B%0A            input.type %3D 'number'%3B%0A            input.id %3D param.id%3B%0A            input.className %3D 'parameter-input'%3B%0A            input.value %3D param.value%3B%0A            input.step %3D 'any'%3B%0A            if (param.id %3D%3D%3D 'errorCorrectionRange') %7B%0A                input.step %3D '1'%3B%0A            %7D%0A    %0A            const help %3D document.createElement('span')%3B%0A            help.className %3D 'help-icon'%3B%0A            help.textContent %3D '%3F'%3B%0A            help.title %3D param.help%3B%0A    %0A            row.appendChild(label)%3B%0A            row.appendChild(input)%3B%0A            row.appendChild(help)%3B%0A            advancedSection.appendChild(row)%3B%0A        %7D)%3B%0A    %0A        panel.appendChild(advancedSection)%3B%0A    %0A        %2F%2F Text input%0A        const textLabel %3D document.createElement('label')%3B%0A        textLabel.className %3D 'typing-simulator-label'%3B%0A        textLabel.textContent %3D 'Text to type%3A'%3B%0A        panel.appendChild(textLabel)%3B%0A    %0A        const textInput %3D document.createElement('textarea')%3B%0A        textInput.id %3D 'text-input'%3B%0A        textInput.className %3D 'typing-simulator-input'%3B%0A        textInput.rows %3D 6%3B%0A        panel.appendChild(textInput)%3B%0A    %0A        %2F%2F Time estimate%0A        const timeEstimate %3D document.createElement('div')%3B%0A        timeEstimate.id %3D 'time-estimate'%3B%0A        panel.appendChild(timeEstimate)%3B%0A    %0A        %2F%2F Start button%0A        const startButton %3D document.createElement('button')%3B%0A        startButton.id %3D 'start-typing'%3B%0A        startButton.className %3D 'typing-simulator-button'%3B%0A        startButton.textContent %3D 'Start Typing'%3B%0A        panel.appendChild(startButton)%3B%0A    %0A        %2F%2F Add panel to document%0A        document.body.appendChild(panel)%3B%0A    %0A        %2F%2F Find toolbar and add button%0A        const toolbar %3D document.querySelector('.docs-titlebar-buttons')%3B%0A        if (toolbar) %7B%0A            debug('Found toolbar%2C inserting button')%3B%0A           toolbar.insertBefore(button%2C toolbar.firstChild)%3B%0A           toolbar.insertBefore(pauseButton%2C button.nextSibling)%3B %2F%2F ✅ add pause button next to it%0A%0A        %7D else %7B%0A            debug('Toolbar not found')%3B%0A        %7D%0A    %0A        %2F%2F Event listeners%0A        button.addEventListener('click'%2C () %3D> %7B%0A            if (currentSimulator%3F.isTyping) %7B%0A                currentSimulator.stopTyping()%3B%0A                const blocker %3D document.querySelector('%23typing-blocker')%3B%0A                blocker.style.display %3D 'none'%3B%0A                blocker.classList.remove('typing-blocker-active')%3B%0A                button.classList.remove('typing-simulator-button-active')%3B%0A                button.textContent %3D 'Type Simulator'%3B%0A                currentSimulator %3D null%3B%0A            %7D else %7B%0A                panel.style.display %3D 'block'%3B%0A            %7D%0A        %7D)%3B%0A        pauseButton.addEventListener('click'%2C () %3D> %7B%0A        if (!currentSimulator) return%3B%0A%0A         if (currentSimulator.isPaused) %7B%0A        currentSimulator.resume()%3B%0A        pauseButton.textContent %3D 'Pause'%3B%0A        %7D else %7B%0A        currentSimulator.pause()%3B%0A        pauseButton.textContent %3D 'Resume'%3B%0A    %7D%0A%7D)%3B%0A%0A    %0A        advancedCheck.addEventListener('change'%2C (e) %3D> %7B%0A            const basicSection %3D document.querySelector('.basic-section')%3B%0A            const advancedSection %3D document.querySelector('.advanced-section')%3B%0A            %0A            if (e.target.checked) %7B%0A                basicSection.classList.add('hidden')%3B%0A                advancedSection.classList.add('visible')%3B%0A            %7D else %7B%0A                basicSection.classList.remove('hidden')%3B%0A                advancedSection.classList.remove('visible')%3B%0A            %7D%0A            updateTimeEstimate()%3B%0A        %7D)%3B%0A    %0A        closeBtn.addEventListener('click'%2C () %3D> %7B%0A            panel.style.display %3D 'none'%3B%0A        %7D)%3B%0A    %0A        textInput.addEventListener('input'%2C updateTimeEstimate)%3B%0A        profileSelect.addEventListener('change'%2C updateTimeEstimate)%3B%0A        startButton.addEventListener('click'%2C startTyping)%3B%0A    %7D%0A%0A    function init() %7B%0A        debug('Script started')%3B%0A        if (document.readyState %3D%3D%3D 'complete') %7B%0A            createUI()%3B%0A        %7D else %7B%0A            window.addEventListener('load'%2C createUI)%3B%0A        %7D%0A    %7D%0A%0A    init()%3B%0A%7D)()%3B%7D)()%3B
